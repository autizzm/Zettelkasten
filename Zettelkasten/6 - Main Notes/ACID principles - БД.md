
21-10-2025 07:55

Status: #child - no info about locks

Tags: [[Базы данных]]

---
# ACID principles - БД


**A** - ***Atomicity** (атомарность)
**C** - ***Consistency*** (постоянство)
**I** - ***Isolation*** (изоляция)
**D** - ***Durability*** (надёжность)


### Atomicity

Система не может оказаться в некорректном промежуточном состоянии. 
Либо действие выполняется целиком, либо сохраняется начальное состояние.

Достигается транзакциями.

![[Pasted image 20251021075854.png]]


### Consistency

Ограничения, которые БД проверяет при произведении действий:
([[Column definition options (Constraints) - SQL|CONSTRAINT]] - CHECK и т.д., FOREIGN KEYs) - проверка корректности добавляемых данных.


![[Pasted image 20251021080048.png]]

Сейчас на БД не делегируют проверку правильности данных - это задача приложения. 

В микросервисной архитектуре консистентность, бывает, обеспечить невозможно, т.к. данные одной базы, принадлежащей одному сервису, могут быть связаны с данными драгой базы другого сервиса => валидируем через само приложение (сервисы).


### Durability

Сохранение данных на диск на случай падения БД.

![[Pasted image 20251021080652.png]]

Изменения зачастую происходят в кэше. - БД сама определяет/мы задаём оптимальный способ to persist the data.


### Isolation

![[Pasted image 20251021080812.png]]

#### Уровни  изоляции

![[Pasted image 20251021083051.png]]

- **Read uncommited** - разрешено читать данные, изменённые, но ещё не зафиксированные другими транзакциями.
- **Read commited** - читаются только зафиксированные изменения. - ~={orange}**Postgres standard**=~
- **Repeatable read** - все данные, прочитанные транзакцией, гарантированно не изменятся другими транзакциями до её завершения.
- **Serializable** - полная изоляция: транзакции выполняются так, как будто они идут последовательно.

#### Аномалии чтения данных

- **Dirty Read** - были ~={yellow}возвращены незафиксированные данные=~.

![[Pasted image 20251021081300.png]]


- **Non-Repeatable read** (non-repeatable - т.к. данные, которые мы прочитали во второй раз не повторяют данные,, прочитанные в первый раз) - ~={yellow}два одинаковых запроса=~ производят чтение~={yellow} одного набора данных=~, но получают ~={yellow}разный результат=~.

![[Pasted image 20251021081610.png]]

(Обычно с Update, Delete)



- **Phantom read** - ~={yellow}два одинаковых запроса=~ возвращают ~={yellow}разное количество данных=~. 

![[Pasted image 20251021081950.png]]

(Обычно с Insert) По сути - почти то же самое, что и **Non-Repeatable Read**


- **Lost Update** - ~={yellow}незафиксированные данные=~ были ~={yellow}перезаписаны=~ другими изменениями.

**`I` тип:**
![[Pasted image 20251021082541.png]]

**`II` тип:**
![[Pasted image 20251021082654.png]]

----
#### [[ACID principles - БД - Flashcards|Link to flashcards]]



---
### References:

