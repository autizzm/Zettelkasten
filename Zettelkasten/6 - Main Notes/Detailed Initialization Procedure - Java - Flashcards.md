
Theory for the cards: [[Detailed Initialization Procedure - Java]]

FILE TAGS: java_core

Q: На каком этапе method signatures классов и интерфейсов попадают в metaspace?
A: При их загрузке (на самом первом этапе)
<!--ID: 1757665134878-->


Q: Что выполняется в процессе инициализации класса?
A: Сначала инициализируется суперкласс и суперинтерфейсы. Затем проверяется, включены ли assertions, если включены - выполняются. И только после этого выполняются static initializer blocks (метод `<clinit`)
<!--ID: 1757665134885-->


Q: Что выполняется при инициализации интерфейса?
A: То же, что и у класса. Сначала инициализируется суперкласс и суперинтерфейсы. Затем проверяется, включены ли assertions, если включены - выполняются. И только после этого выполняются static initializer blocks (метод `<clinit`)
<!--ID: 1757665134891-->

Q: Опиши шаги процесса инициализации класса (после синхронизации потоков)?
A: 1. Загрузка (сохранение method signatures и информации о полях в metaspace)
2. Линковка:
	*  Верификация - проверка байткода
	* Preparation - выделение памяти под static переменные (установка default values для них)
	* Resolution - связывание ссылок на другие классы
3. Инициализация зависимостей (рекурсивно инициализирует суперкласс и все суперинтерфейсы с default-методами)
4. Определение режима assert и выполнение assertions, если они включены.
5. Выполнение static инициализаторов
<!--ID: 1757667452916-->


Q: Когда инициализируются значения констант при инициализации класса? На каком этапе?
A: На этапе компиляции.
<!--ID: 1757666107684-->


Q: Что происходит с неконстантными static переменными после выделения им памяти на этапе Preparations при нициализации до того как будут выполнены их инициализаторы в методе `<clinit>`? Что будет, если попробовать их прочитать?
A: Они получат default values и, при попытке их прочитать, мы получим эти default values.
<!--ID: 1757666107688-->


Q: Сразу ли загружаются и  инициализируются все классы
A: Нет, они загружаются и инициализируются lazily. (при первом активном использовании. Например, доступ к статическому полю, вызов статического метода, создание экземпляра)
<!--ID: 1757666107693-->
